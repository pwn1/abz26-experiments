letting nP be 1000
letting horizon  be 1500
